<!doctype html>
<html lang="it"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Test API</title></head>
<body style="font-family:Arial;padding:24px">
<h1>Test API Portale</h1>
<input id="apiBase" value="https://api.checks.energy/api/v1" style="width:100%;max-width:600px;padding:8px">
<div style="margin-top:10px">
<button id="btnHealth">Test health</button>
<button id="btnDashboard">Test dashboard</button>
</div>
<p id="status">In attesa…</p>
<pre id="out" style="background:#111;color:#eee;padding:12px;border-radius:8px">Nessun output</pre>
<script>
const out=document.getElementById('out'), status=document.getElementById('status'), api=document.getElementById('apiBase');
async function run(url){
  status.textContent='Caricamento...'; out.textContent='';
  try{
    const r=await fetch(url); const t=await r.text(); let d; try{d=JSON.parse(t)}catch{d=t}
    if(!r.ok) throw new Error('HTTP '+r.status+' '+(typeof d==='string'?d:JSON.stringify(d)));
    status.textContent='API collegate ✅'; out.textContent=typeof d==='string'?d:JSON.stringify(d,null,2);
  }catch(e){ status.textContent='Errore API ❌'; out.textContent=String(e); console.error(e); }
}
document.getElementById('btnHealth').onclick=()=>run(api.value.replace(/\/api\/v1\/?$/,'')+'/health');
document.getElementById('btnDashboard').onclick=()=>run(api.value.replace(/\/$/,'')+'/dashboard/summary');
</script>
</body></html>
